<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Outrageous Okona — Daggerheart Adventure (T2-L3)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English:ital@0;1&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --lapis:#3E6EDC;      /* primary accent (brighter royal) */
      --river:#2FA6A0;      /* secondary (brighter teal) */
      --river-dark:#238B84; /* sidebar base */
      --gold:#E2C061;       /* trim (lighter gold) */
      --marble:#F6F8FB;     /* paper */
      --ink:#141E2C;        /* dark bg */
      /* House accents */
      --bellavaro-red:#8C1D1D; --bellavaro-silver:#D1D5DB; --bellavaro-black:#0B0B0B;
      --marivale-blue:#1D4ED8; --marivale-green:#1E7F4F; --marivale-gold:#C9A227;
    }
    body{font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    h1,h2,h3,h4,.font-display{font-family:'IM Fell English',serif}

    .bg-ink{background:var(--ink)} .text-ink{color:var(--ink)}
    .bg-marble{background:var(--marble)} .text-marble{color:var(--marble)}
    .text-lapis{color:var(--lapis)} .bg-lapis{background:var(--lapis)}
    .text-river{color:var(--river)} .bg-river{background:var(--river)}
    .text-gold{color:var(--gold)} .bg-gold{background:var(--gold)}
    .house-bellavaro{color:var(--bellavaro-red)}
    .house-marivale{color:var(--marivale-blue)}

    /* Sidebar gradient + active link behavior (match Hollowshade functionality) */
    .sidebar-grad{
      background:
        linear-gradient(200deg, rgba(0,0,0,.12) 0%, rgba(0,0,0,.24) 60%),
        linear-gradient(200deg, var(--river-dark) 0%, #1E7F79 60%, #2FA6A0 100%);
    }
    .nav-link{display:block;padding:.5rem .75rem;border-radius:.5rem}
    .nav-link:hover{background:rgba(255,255,255,.15)}
    .nav-link.active{background:rgba(255,255,255,.25);border-left:3px solid var(--gold)}

    /* Modal base */
    .modal{position:fixed;inset:0;display:none;background:rgba(0,0,0,.7);z-index:100;justify-content:center;align-items:flex-start}
    .modal.open{display:flex}

    /* Read-aloud (copyable) */
    .read-aloud{background:rgba(255,255,255,.06);border-left:4px solid var(--gold);padding:1rem;position:relative}
    .copy-btn{position:absolute;top:.5rem;right:.5rem;font-size:.75rem;background:rgba(255,255,255,.12);padding:.25rem .5rem;border-radius:.375rem}

    /* Tables */
    table.skill td, table.skill th{border-bottom:1px solid rgba(255,255,255,.15);padding:.45rem .5rem}

    /* Top utility bar (Expand/Collapse) */
    .util-bar{position:sticky;top:0;z-index:50;background:rgba(20,30,44,.85);backdrop-filter:sate(140%) blur(6px)}

    /* Floating back-to-top */
    #backTop{position:fixed;right:1rem;bottom:1rem;display:none}

    /* Print styles (match Hollowshade: show content, hide chrome, open details) */
    @media print{
      aside, header, .util-bar, #backTop, .modal{display:none !important}
      details{border:0}
      details[open] > summary{border-bottom:1px solid #ccc}
      main{padding:0}
      section{break-inside:avoid}
    }
    html{scroll-behavior:smooth}
    section{scroll-margin-top:5rem}
  </style>
</head>
<body class="bg-ink text-marble">
  <!-- Layout: Sidebar + Main (Hollowshade-style) -->
  <div class="min-h-screen grid grid-cols-1 lg:grid-cols-[300px_1fr]">
    <!-- Sidebar -->
    <aside class="sidebar-grad border-r border-white/20 sticky top-0 h-screen hidden lg:flex flex-col">
      <div class="p-5 border-b border-white/20">
        <h1 class="text-xl font-semibold font-display">NAVIGATION</h1>
      </div>
      <nav id="sidebarNav" class="p-4 space-y-1 overflow-y-auto">
        <a class="nav-link" href="#welcome">Welcome</a>
        <a class="nav-link" href="#setting">The Setting</a>
        <a class="nav-link" href="#whatsgoingon">The Intrigue</a>
        <a class="nav-link" href="#developments">Recent Developments</a>
        <a class="nav-link" href="#summary">Adventure Summary</a>
        <a class="nav-link" href="#hooks">Adventure Hooks</a>
        <a class="nav-link" href="#beats">Adventure Beats</a>
        <a class="nav-link" href="#conclusion">Conclusion</a>
        <a class="nav-link" href="#rewards">Rewards & Loot</a>
      </nav>
      <div class="mt-auto p-4 text-xs text-white/70 space-y-1">
        <div>Palette: <span class="text-lapis">Lapis</span> • <span class="text-river">River</span> • <span class="text-gold">Gold</span></div>
        <div>Houses: <span class="house-bellavaro">Bellavaro</span> • <span class="house-marivale">Marivale</span></div>
      </div>
    </aside>

    <!-- Main -->
    <main class="min-h-screen">
      <!-- Top utility bar (Expand/Collapse beats) -->
      <div class="util-bar border-b border-white/20 p-3 flex items-center justify-between">
        <div>
          <div class="text-xs uppercase tracking-wide text-white/70">A Daggerheart Adventure for Level 3 characters</div>
          <h1 class="text-lg font-semibold font-display">The Outrageous Okona</h1>
        </div>
        <div class="flex gap-2">
          <button id="expandAll" class="text-xs px-3 py-1 rounded bg-white/15 hover:bg-white/25">Expand All</button>
          <button id="collapseAll" class="text-xs px-3 py-1 rounded bg-white/15 hover:bg-white/25">Collapse All</button>
        </div>
      </div>

      <!-- Welcome -->
      <section id="welcome" class="p-6 lg:p-10">
        <h2 class="text-3xl font-bold text-gold font-display">Welcome</h2>
        <p class="mt-3 text-white/90">Welcome, Game Master. This adventure module provides everything you need to guide a party of Tier 2, Level 3 heroes through a web of intrigue, high-stakes chases, and dramatic confrontations in the twin cities of Ravenor and Vienetta. The module is designed for a balance of urban exploration, social maneuvering, and thrilling combat, culminating in a dynamic Solo boss fight where words can be as sharp as swords.</p>
        <p class="mt-3 text-white/90">The party arrives among the twin river cities of <span class="house-bellavaro">Ravenor</span> and <span class="house-marivale">Vienetta</span>, where a quiet scandal over the <strong>Jewel of Thessia</strong> has drawn rival bounty crews. The charming courier <strong>Okona</strong> has stepped on too many toes; both houses post bounties, to capture the young rogue <em>alive</em>. A ruthless <strong>Bounty Queen</strong> wants to make an example, while the families push to keep things behind closed doors.</p>
      </section>

      <section id="setting" class="p-6 lg:p-10 border-t border-white/20 bg-white/15">
        <h2 class="text-2xl font-semibold font-display">The Setting</h2>
        <div class="space-y-4 text-white/90">
          <p>The Twin Cities of <strong>Ravenor</strong> and <strong>Vienetta</strong> stand on opposite banks of the wide, swift Artessa River, acting as the region's beating heart of nobility and commerce. They are joined by the <strong>Cattedrale dei Due Ponti</strong> (Cathedral of the Two Bridges), a massive, ancient bridge covered in shops, shrines, and toll-booths that serves as a vital artery of trade and a neutral meeting ground. The entire area is currently swelled with travelers for the annual Festival of Lanterns, choking the gates, markets, and ferries with opportunistic crowds.</p>
          
          <p><strong><span class="house-bellavaro">Ravenor (The Patrician City):</span></strong> West of the river lies Ravenor, a city of high walls, marble facades, and ancestral pride. It is home to the ancient noble families, prestigious dueling schools, and secretive salons where political futures are decided. Ravenor is ruled by <strong>House Bellavaro</strong>, whose motto, <em>"Virtù e Forma"</em> (Virtue and Form), reflects their rigid obsession with honor, reputation, and public perception above all else.</p>
          
          <p><strong><span class="house-marivale">Vienetta (The Mercantile City):</span></strong> East of the river, Vienetta sprawls with a chaotic energy. It is a city of "new money," driven by the ceaseless activity of its counting-houses, customs offices, and sprawling docks. The air smells of foreign spices, salt, and coin. Vienetta is dominated by <strong>House Marivale</strong>, whose motto, <em>"Apri la Via"</em> (Open the Way), showcases their pragmatic and relentless pursuit of profit and expansion.</p>
          
          <p><strong><span class="text-river">The River Wardens:</span></strong> Patrolling the bridge, ferries, and quays are the <strong>River Wardens</strong>. Marked by their silver-wave brooches, they are a neutral constabulary force funded by both Houses, tasked with keeping the peace and ensuring commerce flows. They care more for order than for noble feuds and are the key to the city's formal "private arbitration" process, which is held in an Oath-Court where blue flames are said to gutter in the presence of a lie.</p>
        </div>
      </section>

      <section id="whatsgoingon" class="p-6 lg:p-10">
        <h2 class="text-2xl font-semibold font-display">The Intrigue</h2>
        <div class="space-y-4 text-white/90">
          <p>At the heart of the feud is a forbidden romance between <strong>Yanar Bellavaro</strong> and <strong>Devin Marivale</strong>, the heirs to the two rival houses. Their secret relationship has resulted in Yanar becoming pregnant with Devin's child—a truth only she knows.</p>
          <p>To prevent a catastrophic feud, Yanar desperately lied to her stern father, claiming the father was <strong>Okona</strong>, a charming and transient rogue-courier she barely knows. This lie was meant to buy time, but it backfired spectacularly. Her father, enraged at this perceived dishonor from a low-status outsider, has issued a generous <em>"alive-only"</em> bounty for Okona, intending to force a marriage at sword-point to "correct" the situation.</p>
          <p>Simultaneously, Devin Marivale, wanting to do right by Yanar but unaware of her lie, hired Okona for a separate, simple-sounding job: to deliver the <strong>Jewel of Thessia</strong> (a reset Marivale heirloom) to Yanar as a secret betrothal ring. When House Marivale discovered their heirloom was missing—and seemingly in the hands of the same rogue now publicly accused by House Bellavaro—they assumed theft. They issued their *own* "alive-only" bounty for Okona to recover the jewel.</p>
          <p>Okona is now trapped in the middle, hunted by two great houses and every bounty hunter in the city for reasons he doesn't fully understand. He's a scapegoat for a crime of passion (which he didn't commit) and a thief of an heirloom (which he was trying to deliver). Only Yanar knows the complete truth, while Devin and Okona are left to navigate the explosive consequences of their partial knowledge.</p>
        </div>
      </section>

      <section id="developments" class="p-6 lg:p-10 border-t border-white/20 bg-white/15">
        <h2 class="text-2xl font-semibold font-display">Recent Developments</h2>
        <div class="space-y-4 text-white/90">
          <p>The simmering rivalry between House Bellavaro and House Marivale has finally boiled over, and the talk of the entire city—from its marble salons to its dockside taverns—is of the rogue at the center of it all: the courier Okona. What began as a private scandal has become a public spectacle.</p>
          <p>Public bounty sheets have been posted by both Houses, an unprecedented and crass move that has the city buzzing. In Ravenor, the rumors are of grave dishonor to the Bellavaro name. In Vienetta, the story is of the brazen theft of a priceless heirloom, the Jewel of Thessia. Both bounties are massive, and both demand Okona be brought in <em>alive</em>.</p>
          <p>This massive payday has drawn a dangerous influx of bounty hunters, including the notorious Bounty Queen and her elite vanguard. All of this chaos descends as the city swells for the Festival of Lanterns. The River Wardens, already stretched thin, are struggling to prevent the volatile competition between hunter crews from erupting into open street violence. Meanwhile, Okona's courier skiff has been found impounded, but the man himself has vanished, along with the jewel and the truth of the scandal.</p>
        </div>
      </section>

      <section id="summary" class="p-6 lg:p-10">
        <h2 class="text-2xl font-semibold font-display">Adventure Summary</h2>
        <div class="space-y-4 text-white/90">
          <p>The adventure throws the heroes into the heart of a city-wide scandal. Arriving in Ravenor amidst the Festival of Lanterns, they are immediately caught in the buzz surrounding the "Outrageous Okona," a rogue courier wanted by both rival ruling houses. After hearing the public rumors at the city gates, the party must track down the elusive courier, either finding him mid-chase on the rooftops or, if they are too slow, discovering he's been ambushed and the precious "Jewel of Thessia" stolen by dock thugs.</p>
          <p>Securing Okona and the jewel makes the party a target. They are soon confronted by the Bounty Queen's elite vanguard, the Sibling Hunters, in a dangerous clash on the city quays. Just as the conflict threatens to escalate, the neutral River Wardens intervene, serving a summons for all parties to attend a private arbitration hearing. This tense social encounter is the party's chance to use the clues they've gathered to navigate the grievances of both houses, forcing the truth of the secret romance and pregnancy into the light. Their success or failure at this hearing will determine the final confrontation, where the spurned Bounty Queen, unwilling to be denied her prize, makes one last, decisive move to capture Okona on the steps of the grand cathedral.</p>
        </div>
      </section>

      <section id="hooks" class="p-6 lg:p-10 border-t border-white/20 bg-white/15">
        <h2 class="text-2xl font-semibold font-display">Adventure Hooks</h2>
        <div class="space-y-4 text-white/90">
            <div>
              <h3 class="font-semibold text-gold">1. The Warden's Deputy (Duty & Justice)</h3>
              <p>An old contact within the River Wardens pulls the party aside. The city is a powder keg with the Festival of Lanterns and the competing bounties. The Wardens are stretched thin and can't risk a public street war. They deputize the party with a simple, urgent mission: find Okona first. Bring him to the neutral ground of the Oath-Court for arbitration, *before* the Bounty Queen or the house enforcers can make a bloody spectacle of him. This is a job for heroes who value order and justice over coin.</p>
            </div>
            <div>
              <h3 class="font-semibold text-gold">2. The Scapegoat's Gambit (Gold & Thrills)</h3>
              <p>The party, known for "discreet acquisitions and extractions," receives a coded message from Okona himself. He claims he's been framed in a high-stakes noble spat, is carrying precious cargo, and is willing to pay double the bounty to any crew smart enough to keep him alive. He needs an escort to the Cattedrale dei Due Ponti by the festival's peak, where he promises a "dramatic reveal" will clear his name and secure their payment. This hook is for mercenary or rogue-minded parties who love a high-stakes chase and a massive payout.</p>
            </div>
            <div>
              <h3 class="font-semibold text-gold">3. An Ancient Debt (Mystery & Obligation)</h3>
              <p>One of the PCs (or their patron) owes a generations-old life-debt to House Marivale. A desperate and secret message arrives from the heir, Devin Marivale: "My house believes I was robbed. House Bellavaro believes I am a scoundrel. Both hunt a man who is only guilty of helping me. The future of my house, and a life I hold dear, rests on this. Find Okona. Protect him and the package he carries at all costs. Bring him to the arbitration so I can make this right." This hook plunges the party directly into the heart of the intrigue, forcing them to unravel the mystery to honor their obligation.</p>
            </div>
        </div>
      </section>

      <!-- Beats (collapsible like Hollowshade) -->
      <section id="beats" class="p-6 lg:p-10 border-t border-white/20 bg-white/15">
        <h2 class="text-2xl font-semibold font-display">Adventure Beats</h2>
        <p class="text-white/80 mt-2">Each Beat includes a scene goal, environment, suggested adversaries, countdowns, outcomes, and <span class="italic">4-PC trim</span>. Numbers/stat blocks are T2-L3.</p>

        <!-- Beat 1: Rumors at the Gate -->
        <details class="group border border-white/20 rounded mt-4">
          <summary class="cursor-pointer select-none p-4 bg-ink/40 hover:bg-ink/30 flex items-center justify-between">
            <span class="font-semibold font-display">Beat 1 — Whispers at Westgate (On-Ramp)</span>
            <span class="text-xs text-white/60">Type: Exploration → Social</span>
          </summary>
          <div class="p-4 space-y-3">
            <blockquote class="read-aloud">
              <button class="copy-btn" onclick="window.copyReadAloud(this)">Copy</button>
              The crowds press thick at the Westgate—hawkers, litters, and river-salted sailors. Bounty sheets for Okona flap on every post. A Warden bell rings for order as a rumor knifes through the crowd: “That rogue courier was just seen on the rooftops near the dyers!”
            </blockquote>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Scene Goal</h4>
              <p>Let the party learn about the feud and the bounty; choose whether to take the contract.</p>
              <ul class="list-disc pl-6 mt-2">
                <li><strong>Instinct (Sense) DC 14:</strong> Spot a <em>Pickpocket Crew</em> working the crowd; catching one yields gossip and a half-written love note (R1 fragment).</li>
                <li><strong>Knowledge (Recall) DC 14:</strong> Identify both house crests on the bounty bills.</li>
                <li><strong>Presence (Persuade) DC 13:</strong> Get a Warden to confirm the skiff was impounded (leads to Beat 2).</li>
              </ul>
            </div>
            <div class="p-3 rounded bg-white/10 border border-white/20">
              <div class="font-semibold">Quick Stat Blocks</div>
              <div class="flex flex-wrap gap-2 mt-2 text-sm">
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showEnvironment('gatePress')">Environment</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showAdversary('informantSkulk')">Informant Skulk</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showAdversary('pickpockets')">Pickpocket Minions</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showAdversary('cityWarden')">River Warden (Standard)</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showSocial('b1')">Social</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showLoot('b1')">Loot</button>
              </div>
            </div>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Outcomes</h4>
              <p>Accepting the bounty sets <em>Okona alive-only</em> as the main objective. Tailing informants or following the rumor leads to Beat 2.</p>
            </div>
          </div>
        </details>

        <!-- Beat 2a: Escort the Courier (early find) -->
        <details class="group border border-white/20 rounded mt-4">
          <summary class="cursor-pointer select-none p-4 bg-ink/40 hover:bg-ink/30 flex items-center justify-between">
            <span class="font-semibold font-display">Beat 2a — Escort the Courier</span>
            <span class="text-xs text-white/60">Type: Traversal → Social</span>
          </summary>
          <div class="p-4 space-y-3">
            <blockquote class="read-aloud">
              <button class="copy-btn" onclick="window.copyReadAloud(this)">Copy</button>
              Slate roofs ripple ahead; laundry lines snap in the wind. A bright-cloaked figure vaults a gap with a mocking bow—Okona. Rivals scramble after him with grapnels and curses.
            </blockquote>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Scene Goal</h4>
              <p>Meet Okona and keep hunters off him while crossing rooftops toward a safe rendezvous.</p>
              <ul class="list-disc pl-6 mt-2">
                <li><strong>Dynamic Progress “Keep Him Moving” (6):</strong> Agility (Move) or Strength (Push) DC 14 advances; failures trigger rooftop hazards.</li>
                <li><strong>Parley:</strong> Presence (Persuade/Deceive) DC 14 earns Okona’s trust; he hints at the lovers and the jewel’s real purpose.</li>
              </ul>
              <p class="text-white/70 text-sm"><strong>4-PC Trim:</strong> Remove 2 Rookie Hunters or reduce the traversal clock to 5.</p>
            </div>
            <div class="p-3 rounded bg-white/10 border border-white/20">
              <div class="font-semibold">Quick Stat Blocks</div>
              <div class="flex flex-wrap gap-2 mt-2 text-sm">
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showEnvironment('rooftops')">Environment</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showAdversary('grapnelSkulk')">Grapnel Skulk</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showAdversary('rookieMinions')">Rookie Hunters (Minions)</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showSocial('b2')">Social</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showLoot('b2')">Loot</button>
              </div>
            </div>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Clues & Outcomes</h4>
              <ul class="list-disc pl-6 mt-1">
                <li>Okona drops a <em>ferry chit</em> or mentions patrol logs (pointer to later movement).</li>
                <li>If protected, he stays in possession of the Jewel; if overwhelmed, proceed to 2b to recover it from thugs.</li>
              </ul>
            </div>
          </div>
        </details>

        <!-- Beat 2b: Chase the Thugs (late find) -->
        <details class="group border border-white/20 rounded mt-4">
          <summary class="cursor-pointer select-none p-4 bg-ink/40 hover:bg-ink/30 flex items-center justify-between">
            <span class="font-semibold font-display">Beat 2b — Chase the Thugs</span>
            <span class="text-xs text-white/60">Type: Combat + Traversal</span>
          </summary>
          <div class="p-4 space-y-3">
            <blockquote class="read-aloud">
              <button class="copy-btn" onclick="window.copyReadAloud(this)">Copy</button>
              Okona is bloodied but defiant; a dockside crew tears away with a small velvet case—the Jewel. Alleys and warehouse lanes become a gauntlet of hooks, nets, and swinging crates.
            </blockquote>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Scene Goal</h4>
              <p>Run down the thieves and reclaim the Jewel. The thugs are lucky, not elite.</p>
              <ul class="list-disc pl-6 mt-2">
                <li><strong>Dynamic Progress “Cut Them Off” (6):</strong> Agility (Move) / Instinct (Navigate) DC 14.</li>
                <li><strong>Consequence:</strong> On failures, trigger <em>Warehouse Alleys</em> hazards.</li>
              </ul>
              <p class="text-white/70 text-sm"><strong>4-PC Trim:</strong> Reduce Dock Thugs to (4) or drop the Lookout.</p>
            </div>
            <div class="p-3 rounded bg-white/10 border border-white/20">
              <div class="font-semibold">Quick Stat Blocks</div>
              <div class="flex flex-wrap gap-2 mt-2 text-sm">
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showEnvironment('warehouse')">Environment (alleys/warehouse)</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showAdversary('dockMinions')">Dock Thugs (Minions)</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showAdversary('skulkLookout')">Rafter Lookout (Skulk)</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showLoot('b2a')">Loot</button>
              </div>
            </div>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Clues & Outcomes</h4>
              <ul class="list-disc pl-6 mt-1">
                <li>Recover the Jewel. A pawn-stub or ledger mark points toward provenance documents (R3 later).</li>
              </ul>
            </div>
          </div>
        </details>

        <!-- Beat 3: Posse on the Quay (Mini-Boss) -->
        <details class="group border border-white/20 rounded mt-4">
          <summary class="cursor-pointer select-none p-4 bg-ink/40 hover:bg-ink/30 flex items-center justify-between">
            <span class="font-semibold font-display">Beat 3 — Posse on the Quay (Mini-Boss)</span>
            <span class="text-xs text-white/60">Type: Combat</span>
          </summary>
          <div class="p-4 space-y-3">
            <blockquote class="read-aloud">
              <button class="copy-btn" onclick="window.copyReadAloud(this)">Copy</button>
              Lantern-lines sway over the quay. A woman with hook-swords smiles, a man levels a repeating crossbow. “The Queen sends her regards. The courier stays breathing. You don’t.”
            </blockquote>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Scene Goal</h4>
              <p>Survive the ambush by the Sibling Hunters and keep control of Okona (and the Jewel, if recovered).</p>
              <p class="text-white/70 text-sm"><strong>4-PC Trim:</strong> Remove <em>Posse Cutthroat</em> support or reduce the Duo’s Stress by 1.</p>
            </div>
            <div class="p-3 rounded bg-white/10 border border-white/20">
              <div class="font-semibold">Quick Stat Blocks</div>
              <div class="flex flex-wrap gap-2 mt-2 text-sm">
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showEnvironment('cranes')">Environment</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showAdversary('siblingDuo')">Sibling Hunter Duo</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showAdversary('supportStandard')">Support Standards</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showLoot('b3')">Loot</button>
              </div>
            </div>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Outcomes</h4>
              <ul class="list-disc pl-6 mt-1">
                <li>Contract copy on the Duo references “unmaimed” delivery and a personal grudge (points to Queen).</li>
              </ul>
            </div>
          </div>
        </details>

        <!-- Beat 4: Warden Summons (Neutral) -->
        <details class="group border border-white/20 rounded mt-4">
          <summary class="cursor-pointer select-none p-4 bg-ink/40 hover:bg-ink/30 flex items-center justify-between">
            <span class="font-semibold font-display">Beat 4 — Warden Summons (Neutral)</span>
            <span class="text-xs text-white/60">Type: Social</span>
          </summary>
          <div class="p-4 space-y-3">
            <blockquote class="read-aloud">
              <button class="copy-btn" onclick="window.copyReadAloud(this)">Copy</button>
              River Wardens in silver-wave brooches approach with open hands. “By the peace of the Twin Cities, present yourselves for private arbitration. No scandal—no blood.”
            </blockquote>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Scene Goal</h4>
              <p>Decide whether to comply. Resisting leads to arrests and disadvantage in the hearing.</p>
              <table class="skill w-full text-sm mt-2">
                <thead><tr><th class="text-left">Check</th><th class="text-left">DC</th><th class="text-left">Effect</th></tr></thead>
                <tbody>
                  <tr><td>Presence (Parley)</td><td>14</td><td>Wardens permit escorts and weapons peace-bound (ribbons).</td></tr>
                  <tr><td>Instinct (Sense)</td><td>13</td><td>Wardens truly neutral; houses want quiet.</td></tr>
                  <tr><td>Agility/Strength (if resisting)</td><td>14</td><td>Failure → brief detention; −2 forward on the hearing’s first roll.</td></tr>
                </tbody>
              </table>
            </div>
            <div class="p-3 rounded bg-white/10 border border-white/20">
              <div class="font-semibold">Quick Stat Blocks</div>
              <div class="flex flex-wrap gap-2 mt-2 text-sm">
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showSocial('b6')">Social</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showAdversary('cityWarden')">River Wardens</button>
              </div>
            </div>
          </div>
        </details>

        <!-- Beat 5: Oath-Court Arbitration -->
        <details class="group border border-white/20 rounded mt-4">
          <summary class="cursor-pointer select-none p-4 bg-ink/40 hover:bg-ink/30 flex items-center justify-between">
            <span class="font-semibold font-display">Beat 5 — Oath-Court Arbitration</span>
            <span class="text-xs text-white/60">Type: Social</span>
          </summary>
          <div class="p-4 space-y-3">
            <blockquote class="read-aloud">
              <button class="copy-btn" onclick="window.copyReadAloud(this)">Copy</button>
              Blue oath-flames gutter when lies are told. Bellavaro pride and Marivale gold face each other across polished stone while clerks scratch every word.
            </blockquote>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Scene Goal</h4>
              <p>Use evidence and testimony to clear Okona without public scandal; allow Devin to confess.</p>
              <table class="skill w-full text-sm mt-2">
                <thead><tr><th class="text-left">Argument / Evidence</th><th class="text-left">Check</th><th class="text-left">DC</th><th class="text-left">Result</th></tr></thead>
                <tbody>
                  <tr><td>Decoded letters (R1)</td><td>Presence (Persuade)</td><td>15</td><td>Shows Okona as courier only; +1 forward to next roll.</td></tr>
                  <tr><td>Pregnancy reveal (R2)</td><td>Presence (Soothe)</td><td>15</td><td>Bellavaro backs off public shaming; −1 Fear spend allowed this scene.</td></tr>
                  <tr><td>Bond ledger (R3)</td><td>Finesse (Tinker) or Presence (Deceive to procure)</td><td>15/16</td><td>Proves ring ownership by Devin; undermines theft claim.</td></tr>
                  <tr><td>Betrothal draft (R6)</td><td>Instinct (Investigate)</td><td>14</td><td>Shows consent; fractures Matriarch’s leverage.</td></tr>
                  <tr><td>Devin’s confession</td><td>Presence (Persuade/Support)</td><td>14</td><td>Settlement: rescind bounties, private union announced later.</td></tr>
                </tbody>
              </table>
              <p class="text-white/70 text-sm"><strong>Failing Forward:</strong> If the party blunders, Okona is bound over for a day; proceed to Beat 6 with social disadvantages.</p>
            </div>
            <div class="p-3 rounded bg-white/10 border border-white/20">
              <div class="font-semibold">Quick Stat Blocks</div>
              <div class="flex flex-wrap gap-2 mt-2 text-sm">
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showEnvironment('oathcourt')">Environment</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showSocial('b9')">Social Interludes</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showLoot('b7')">Loot</button>
              </div>
            </div>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Outcomes</h4>
              <ul class="list-disc pl-6 mt-1">
                <li><strong>Good Ending (here):</strong> Okona cleared; lovers’ union recognized in private; writs granted.</li>
                <li><strong>Mixed:</strong> Okona released into Warden custody pending paperwork → Beat 6 still triggers outside.</li>
              </ul>
            </div>
          </div>
        </details>

        <!-- Beat 6: The Queen’s Last Grab (Solo) -->
        <details class="group border border-white/20 rounded mt-4">
          <summary class="cursor-pointer select-none p-4 bg-ink/40 hover:bg-ink/30 flex items-center justify-between">
            <span class="font-semibold font-display">Beat 6 — The Queen’s Last Grab (Finale: SOLO)</span>
            <span class="text-xs text-white/60">Type: Combat + Social Interludes</span>
          </summary>
          <div class="p-4 space-y-3">
            <blockquote class="read-aloud">
              <button class="copy-btn" onclick="window.copyReadAloud(this)">Copy</button>
              The courthouse doors boom open as the crowd spills to the steps. The Bounty Queen’s energized rapier crackles as nets snap from hidden launchers. “Contract’s still good—until you make me let go.”
            </blockquote>
            <div>
              <h4 class="font-display text-lg text-gold font-semibold">Scene Goal</h4>
              <p>Defeat the Queen by force or by dismantling her claim with public testimony (use the evidence gathered).</p>
              <ul class="list-disc pl-6 mt-1">
                <li><strong>Social Interlude:</strong> A PC may spend their action to present one piece of evidence (R1, R2, R3, R6). Presence (Persuade) DC 16. Each success disables one Environment Engine. After <strong>3</strong> successes the Wardens void the claim and arrest the Queen.</li>
                <li class="text-white/70 text-sm"><strong>4-PC Trim:</strong> Set Relentless 2 <em>or</em> remove Bell Pulse engine.</li>
              </ul>
            </div>
            <div class="p-3 rounded bg-white/10 border border-white/20">
              <div class="font-semibold">Quick Stat Blocks</div>
              <div class="flex flex-wrap gap-2 mt-2 text-sm">
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showEnvironment('cathedral')">Environment</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showAdversary('bountyQueen')">The Bounty Queen (Solo)</button>
                <button class="px-2 py-1 bg-white/20 rounded" onclick="window.showLoot('b9')">Loot</button>
              </div>
            </div>
          </div>
        </details>
      </section>

      <!-- Conclusion & Rewards -->
      <section id="conclusion" class="p-6 lg:p-10">
        <h2 class="text-2xl font-semibold font-display">Conclusion</h2>
        <div class="space-y-4">
          <div>
            <h3 class="text-gold font-semibold">Turn-In Branch</h3>
            <p>If the PCs turn in Okona early: with the Jewel in his possession and letters decoded, the houses choose discretion—<em>good ending</em>. Without the Jewel/evidence, Okona is jailed or banished—<em>bad ending</em> (he later escapes, strained toward the PCs).</p>
          </div>
          <div>
            <h3 class="text-gold font-semibold">Courtly Peace</h3>
            <p>If the PCs win arbitration or void the Queen’s claim, the lovers announce their union; bounties are rescinded; the feud cools. The city remembers the party kindly.</p>
          </div>
          <div>
            <h3 class="text-gold font-semibold">Fractured Peace</h3>
            <p>If the PCs fail, the Queen escapes, vows revenge, and the cities tighten law—hook for a river-heist sequel to free Okona.</p>
          </div>
        </div>
      </section>

      <section id="rewards" class="p-6 lg:p-10 border-t border-white/20 bg-white/15">
        <h2 class="text-2xl font-semibold font-display">Rewards & Loot</h2>
        <p class="mt-2">On successful completion, advance to <strong>Level 4</strong>. Grant:</p>
        <ul class="list-disc pl-6 mt-2 space-y-2">
          <li><strong class="text-gold">Writ of Free Passage:</strong> Toll-free transit and priority moorage; advantage with Wardens once per scene.</li>
          <li><strong class="text-gold">River Warden’s Silver Brooch:</strong> Marks PCs as deputies; advantage on one Presence roll with officials per scene.</li>
          <li><strong class="text-gold">A “Chest” of Gold:</strong> Either unified houses’ thanks or hush money—GM’s choice by outcome.</li>
          <li class="text-white/70"><em>Note:</em> The Jewel of Thessia is a story artifact (proposal ring), not a party reward.</li>
        </ul>
      </section>

      <footer class="p-6 lg:p-10 text-xs text-white/60">
        Built for Daggerheart SRD • Adversary math: Making Custom Adversaries v1.4 • Solo principles: Single Adversary Advice. UI: modal stat blocks, collapsible beats. Palette: cool river + lapis + gold.
      </footer>
    </main>
  </div>

  <!-- Floating Back to Top (Hollowshade-style helper) -->
  <button id="backTop" class="px-3 py-2 rounded bg-lapis text-white/90 hover:opacity-90">Top</button>

  <!-- Modal (stat blocks) -->
  <div id="modal" class="modal items-start justify-center p-4" onclick="closeModal()">
    <div class="max-w-3xl w-full mt-16 rounded-lg border border-white/20 bg-ink shadow-xl" onclick="event.stopPropagation()">
      <div class="flex items-center justify-between px-4 py-3 border-b border-white/20">
        <h3 id="modalTitle" class="text-lg font-semibold text-gold font-display">Stat Block</h3>
        <button class="px-2 py-1 bg-white/20 rounded" onclick="closeModal()">Close</button>
      </div>
      <div id="modalBody" class="p-4 text-sm"></div>
    </div>
  </div>

  <script>
    // ===== Scrollspy (Hollowshade functionality) =====
    const navLinks = Array.from(document.querySelectorAll('#sidebarNav .nav-link'));
    const sections = navLinks.map(a=>document.querySelector(a.getAttribute('href'))).filter(Boolean);
    const spy = ()=>{
      let idx = sections.findIndex(sec=>sec.getBoundingClientRect().top > 80) - 1;
      if(idx < 0) idx = sections.length - 1;
      navLinks.forEach((a,i)=>a.classList.toggle('active', i===idx));
    };
    document.addEventListener('scroll', spy, {passive:true});
    window.addEventListener('load', spy);

    // ===== Expand/Collapse All Beats =====
    const expandAllBtn = document.getElementById('expandAll');
    const collapseAllBtn = document.getElementById('collapseAll');
    function setAllDetails(open){ document.querySelectorAll('#beats details').forEach(d=>d.open=open); }
    expandAllBtn.addEventListener('click', ()=>setAllDetails(true));
    collapseAllBtn.addEventListener('click', ()=>setAllDetails(false));

    // ===== Back to Top =====
    const backTop = document.getElementById('backTop');
    backTop.addEventListener('click', ()=>window.scrollTo({top:0,behavior:'smooth'}));
    document.addEventListener('scroll', ()=>{ backTop.style.display = window.scrollY > 400 ? 'block' : 'none'; }, {passive:true});

    // ===== MODAL CORE =====
    function openModal(title, html){ const m=document.getElementById('modal'); if(!m) return; document.getElementById('modalTitle').textContent=title; document.getElementById('modalBody').innerHTML=html; m.classList.add('open'); }
    function closeModal(){ const m=document.getElementById('modal'); if(m) m.classList.remove('open'); }
    document.addEventListener('keydown', e=>{ if(e.key==='Escape') closeModal(); });

    // ===== Copy Read-Aloud Text (regex-free to avoid escaping problems) =====
    function copyReadAloud(btn){
      const raw = btn.parentElement.innerText;
      const txt = raw.startsWith('Copy') ? raw.slice(4).trimStart() : raw;
      navigator.clipboard.writeText(txt).then(()=>{ btn.textContent='Copied'; setTimeout(()=>btn.textContent='Copy',1000); });
    }

    // ===== UTIL for modal tables =====
    const row = (k,v)=>`<tr class'border-b border-white/20'><td class='py-1 pr-3 text-white/70'>${k}</td><td class='py-1'>${v}</td></tr>`;
    const list = arr=>arr.map(x=>`<li class='list-disc ml-5'>${x}</li>`).join('');

    // ===== DATA: Adversaries (T2-L3) =====
    const adversaryData = {
      // Beat 1 / Wardens
      informantSkulk:{name:'Informant Skulk',source:'Street',role:'Skulk',tier:'T2-L3',relentless:0,difficulty:13,thresholds:'8 / 18',hp:4,stress:3,atk:'+2 Dagger (Melee)',damage:'2d6+3 phy',experience:'Streetwise +3',features:[
        'Whisper Network — Allies gain +1 ATK vs a PC you failed a roll against this round.',
        'Slip Away — Reaction: When targeted at Far range, mark a Stress to break line of sight.'
      ]},
      pickpockets:{name:'Pickpocket Crew',source:'Street',role:'Minions (5)',tier:'T2-L3',relentless:0,difficulty:12,thresholds:'—',hp:'1 ea',stress:'1',atk:'−1 Shiv (Melee)',damage:'3 phy',experience:'Sticky Fingers +2',features:[
        'Minion (5) — Any damage defeats one; every 5 damage defeats an extra Minion.',
        'Cut Purse — On a success, steal a small item or 1 Handful of gold instead of damage.'
      ]},
      cityWarden:{name:'River Warden',source:'Wardens',role:'Standard',tier:'T2-L3',relentless:0,difficulty:14,thresholds:'10 / 20',hp:6,stress:3,atk:'+1 Halberd (Close)',damage:'2d8+2 phy',experience:'Authority +2',features:[
        'Neutral Enforcement — Seeks de-escalation; advantage to checks to parley or restrain without harm.',
        'Clapper Whistle — Action: Spotlight a Warden next round rather than raising alarms.'
      ]},
      // Beat 2a/2b
      grapnelSkulk:{name:'Grapnel Skulk',source:'Rivals',role:'Skulk',tier:'T2-L3',relentless:0,difficulty:13,thresholds:'8 / 18',hp:4,stress:3,atk:'+2 Garrote (Melee)',damage:'2d6+3 phy',experience:'Acrobatics +3',features:[
        'Grapnel Line — Pull a target within Close; on success also reposition yourself.',
        'High Perch — +2 Difficulty while on rooftops.'
      ]},
      rookieMinions:{name:'Rookie Hunters',source:'Rivals',role:'Minions (4)',tier:'T2-L3',relentless:0,difficulty:12,thresholds:'—',hp:'1 ea',stress:'1',atk:'0 Club (Melee)',damage:'2 phy',experience:'Eager +1',features:[
        'Minion (4)','Group Attack — Spend Fear: rookies make one combined attack.'
      ]},
      dockMinions:{name:'Dock Thugs',source:'Street',role:'Minions (6)',tier:'T2-L3',relentless:0,difficulty:12,thresholds:'—',hp:'1 ea',stress:'1',atk:'−1 Hooks (Melee)',damage:'3 phy',experience:'Stevedore +2',features:[
        'Minion (6)','Shove to Water — Reaction: On an ally success in Melee, force target 1 range toward River.'
      ]},
      skulkLookout:{name:'Rafter Lookout',source:'Street',role:'Skulk',tier:'T2-L3',relentless:0,difficulty:13,thresholds:'8 / 18',hp:4,stress:3,atk:'+2 Light Crossbow (Far)',damage:'2d6+3 phy',experience:'Scout +3',features:[
        'Pinning Shot — Mark a Stress to Immobilize on hit.',
        'Rope Slide — Reaction: When engaged in Melee, Disengage to Far.'
      ]},
      // Beat 3
      siblingDuo:{name:'Sibling Hunter Duo',source:'Rivals',role:'Co-Boss (2× Elite Standards)',tier:'T2-L3',relentless:1,difficulty:15,thresholds:'12 / 22',hp:7,stress:4,atk:'+3 Mixed',damage:'2d8+4 phy',experience:'Teamwork +3',features:[
        'Jago (Sniper) — ATK +3 Repeating Crossbow (Far), DMG 2d8+3 phy; Action: Pinning Shot (Restrains on success, Str DC 14 to break).',
        'Kora (Hunter) — ATK +3 Hook-Swords (Melee), DMG 2d6+5 phy; Reaction: Intercept (move and attack when an enemy enters Jago’s Melee).',
        'Synergy — When Jago Restrains a target, Kora may use Intercept free and with advantage.'
      ]},
      supportStandard:{name:'Posse Cutthroat',source:'Rivals',role:'Standard',tier:'T2-L3',relentless:0,difficulty:14,thresholds:'10 / 19',hp:5,stress:3,atk:'+2 Saber (Melee)',damage:'2d6+4 phy',experience:'Pack Tactics +2',features:[
        'Assist the Boss — When adjacent to a Duo member, they gain +1 ATK.',
        'Dirty Trick — Action: Sand toss; target makes Agility RR (DC 14) or is Disadvantaged next roll.'
      ]},
      // Finale Solo
      bountyQueen:{name:'The Bounty Queen',source:'Nemesis',role:'Solo',tier:'T2-L3',relentless:3,difficulty:16,thresholds:'14 / 27',hp:10,stress:5,atk:'+4 Energized Rapier (Melee)',damage:'2d10+4 phy',experience:'Intimidation +3, Acrobatics +2',features:[
        'Relentless (3) — May be spotlighted up to three times per GM turn (spend Fear as usual).',
        'Momentum — When she hits, gain 1 Fear.',
        'Duelist’s Eye — Advantage vs targets not adjacent to their allies.',
        'Whip Lash — Action: + pull into Melee and Restrain (mark 1 Stress).',
        'Casting Net — Action (Fear): Very Close area must Agility RR (DC 15) or become Restrained.',
        'Ricochet Parry — Reaction: On a melee miss against her, attacker Agility RR (DC 14) or hit an adjacent target instead.'
      ]}
    };

    // ===== DATA: Environments =====
    const environmentData = {
      gatePress:{name:'Gate & Market Press',type:'Event',tier:'T2',difficulty:'14',impulses:['Crowd surges','Hawkers obstruct','Wardens inspect'],features:[
        'Crowd Surge — Action (Fear): all PCs Agility RR (DC 14) or moved a band and mark 1 Stress.',
        'Aggressive Hawker — Action: target Presence RR (DC 13) or delayed; next roll against them gains advantage.'
      ]},
      rooftops:{name:'Rooftops & Laundry Lines',type:'Traversal',tier:'T2',difficulty:'14',impulses:['Wind gust','Snapping line','Brittle slate'],features:[
        'Brittle Slate — On failed Agility (Move), mark 1 Stress or fall (2d10+2 phy).',
        'Snapping Line — Action (Fear): Agility RR (DC 14) or Prone + briefly Restrained.'
      ]},
      warehouse:{name:'Warehouse Alleys',type:'Event/Traversal',tier:'T2',difficulty:'14',impulses:['Pulley swing','Oil spill ignite','Skylight drop'],features:[
        'Ignite Oil Slick — Action (Fear): create fire lane; 2d6+3 mag on enter/start.',
        'Pulley Drop — Action: cut a rope; target Agility RR (DC 15) or 2d12+4 phy.'
      ]},
      cranes:{name:'Cranes & Cargo Nets',type:'Event',tier:'T2',difficulty:'14',impulses:['Swinging crates','Loose grain (slick)','River swell'],features:[
        'Swinging Crate — Action (Fear): line; Agility RR (DC 14) or Prone + 2d8+5 phy.',
        'Cargo Net — Action: drop net; Restrained until Finesse/Strength DC 14.'
      ]},
      oathcourt:{name:'Oath-Court Chamber',type:'Social',tier:'T2',difficulty:'15',impulses:['Oathflame flares','Clerks interject','Guard shuffles'],features:[
        'Oathflame — Detects significant lies; advantage to Instinct (Sense).',
        'Formal Grievance — Action (Fear): opposing counsel forces Presence RR (DC 15) or party marks 2 Stress.'
      ]},
      cathedral:{name:'Courthouse Steps & Crowds',type:'Event',tier:'T2',difficulty:'16',impulses:['Net launcher lanes','Bell pulse','Panic surges','Public contract'],features:[
        'Net Launcher — Action: Agility RR (DC 15) or Restrained.',
        'Bell Tower Pulse — Action (Fear): Strength RR (DC 14) or mark 2 Stress + push back.',
        'Crowd Panic — Action: choose a line; all moved a band and become Vulnerable next turn.',
        'Social Interlude — PC action: Presence (Persuade) DC 16 with R1–R6 evidence; on success disable one Engine; 3 successes void claim.'
      ]}
    };

    // ===== DATA: Social + Loot (light scaffolds) =====
    const socialData = {
      b1:{title:'Beat 1 Social — Rumor Net',lines:[
        'Tavern gossip: “Marivale gold versus Bellavaro pride.”',
        'Porter whispers: a courier seen dodging rooftops near dyers.’',
        'Crier hint: both houses posted alive-only bounties.'
      ]},
      b2:{title:'Beat 2a Social — Okona Parley',lines:[
        '“I deliver letters, not scandals.”',
        '“Keep me breathing and I’ll make you richer than the bounty.”'
      ]},
      b6:{title:'Beat 4 Social — Warden Summons',lines:[
        '“By the peace of the Twin Cities, present yourselves at arbitration.”',
        '“Comply, and no one spends the night in a cell.”'
      ]},
      b9:{title:'Beat 5 Social — Arbitration Levers',lines:[
        'Present R1, R2, R3, R6 as proofs.',
        'Devin’s confession closes the loop without scandal.'
      ]}
    };

    const lootData = {
      b1:{title:'Beat 1 Loot',items:[
        'Handful of Gold ×1d4',
        'Common: Festival Tonic (1/use: remove Prone or gain +1 to a single Agility RR this scene)'
      ]},
      b2:{title:'Beat 2a Loot',items:[
        'Handful of Gold ×1d4',
        'Uncommon: Rooftop Hook (1/use: move 1 band ignoring terrain)'
      ]},
      b2a:{title:'Beat 2b Loot',items:[
        'Handful of Gold ×1d6',
        'Common: Smoke Pellet (1/use: create Disadvantaged zone Very Close for 1 round)'
      ]},
      b3:{title:'Beat 3 Loot',items:[
        'Handful of Gold ×1d6',
        'Uncommon: Reinforced Net (1/use: Restrains on hit; Str DC 14 to break)'
      ]},
      b7:{title:'Beat 5 Loot',items:[
        'Chest of Gold (payout or hush money)',
        'Writ of Free Passage (story reward)'
      ]},
      b9:{title:'Beat 6 Loot',items:[
        'River Warden’s Silver Brooch (story reward)' ]}
    };

    // ===== MODAL BUILDERS =====
    function showAdversary(key){ const a = adversaryData[key]; if(!a) return; const tbl = `
        <table class='w-full text-sm mb-3'><tbody>
          ${row('Source',a.source)}
          ${row('Role/Tier', `${a.role} • ${a.tier}`)}
          ${row('Difficulty', `<strong>${a.difficulty}</strong>`)}
          ${row('HP / Stress', `<strong>${a.hp}</strong> / <strong>${a.stress}</strong>`)}
          ${row('Thresholds', a.thresholds)}
          ${row('Attack', a.atk)}
          ${row('Damage', a.damage)}
          ${row('Experience', a.experience || '—')}
        </tbody></table>`;
      const html = `
        <h4 class='text-lg font-semibold font-display mb-2 text-gold'>${a.name}</h4>
        ${tbl}
        <div class='text-sm font-semibold mb-1 font-display'>Features</div>
        <ul class='space-y-1'>${list(a.features||[])}</ul>`;
      openModal(a.name, html);
    }

    function showEnvironment(key){ const e = environmentData[key]; if(!e) return; const tbl = `
        <table class'w-full text-sm mb-3'><tbody>
          ${row('Type/Tier', `${e.type} • ${e.tier}`)}
          ${row('Difficulty', `<strong>${e.difficulty}</strong>`)}
        </tbody></table>`;
      const html = `
        <h4 class='text-lg font-semibold font-display mb-2 text-gold'>${e.name}</h4>
        ${tbl}
        <div class='text-sm font-semibold mb-1 font-display'>Impulses</div>
        <ul class='space-y-1 text-white/90 mb-3'>${list(e.impulses||[])}</ul>
        <div class='text-sm font-semibold mb-1 font-display'>Features</div>
        <ul class='space-y-1'>${list(e.features||[])}</ul>`;
      openModal('Environment: '+e.name, html);
    }

    function showSocial(key){ const s = socialData[key]; if(!s) return; const html = `
      <h4 class='text-lg font-semibold font-display mb-2 text-gold'>${s.title}</h4>
      <ul class='space-y-1'>${list(s.lines||[])}</ul>`;
      openModal('Social: '+s.title, html);
    }

    function showLoot(key){ const l = lootData[key]; if(!l) return; const html = `
      <h4 class='text-lg font-semibold font-display mb-2 text-gold'>${l.title}</h4>
      <ul class='space-y-1'>${list(l.items||[])}</ul>`;
      openModal('Loot: '+l.title, html);
    }

    // Expose helpers
    window.openModal = openModal; window.closeModal = closeModal;
    window.showAdversary = showAdversary; window.showEnvironment = showEnvironment; window.showSocial = showSocial; window.showLoot = showLoot;
    window.copyReadAloud = copyReadAloud;

    // ===== Sidebar Smooth Scroll (Fix) =====
    function handleSmoothScroll(event) {
        event.preventDefault();
        const targetId = event.currentTarget.getAttribute('href');
        const targetElement = document.querySelector(targetId);
        if (targetElement) {
            targetElement.scrollIntoView({ behavior: 'smooth' });
        }
    }
    
    // Attach scroll listeners on DOM ready
    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('#sidebarNav .nav-link').forEach(link => {
            link.addEventListener('click', handleSmoothScroll);
        });
    });
  </script>
</body>
</html>

